openapi: 3.0.0

info:
  contact:
    name: TEAM CRM
  description: CWDR-CRM API
  title: RESTful API's for CWDR CRM
  version: 1.0.0
  termsOfService: 'https://cwdebtrelief.com/terms-of-service'
  license:
    name: Proprietry
tags:
  - name: Other Leads
    description: Other Lead APIs

servers:
  - description: Production
    url: ''
    
  - description: Production Internal Load Balancer 
    url: ''

  - description: Test 
    url: ''
    
  - description: Test Internal Load Balancer 
    url: ''

paths:
  /ExternalLeads:
    post:
      tags:
        - Other Leads
      description: |
        The Leads from the third party vendors.
      operationId: ExternalLeads
      requestBody:
        $ref: "#/components/requestBodies/ExternalLeads"
      responses:
        "200":
          description: ok
          content:
            application/json:
              schema:
                type: object
                required:
                  - crm_leads
                  - crm_contact_id
                properties:
                  crm_leads:
                    type: object
                    additionalProperties:
                      type: string
                    example:
                        "string1": "8030001"
                        "string2": "8030002"
                        "string3": "8030003"
                  crm_contact_id:
                    type: string
                    maxLength: 24
                    description: Crm Contact Id
        "400":
          $ref: "#/components/responses/BadRequest"
        "401":
          $ref: "#/components/responses/Unauthorized"
        "403":
          $ref: "#/components/responses/Forbidden"
        "404":
          $ref: "#/components/responses/NotFound"
        "500":
          $ref: "#/components/responses/InternalServerError"
        "502":
          $ref: '#/components/responses/BadGateway'
        "503":
          $ref: '#/components/responses/MaintenanceMode'

# API Key's are defined below
security:
  - x_api_key: []

# All $ref are referenced from below here
components:
  # API Key's are here
  securitySchemes:
    x_api_key:
      type: apiKey
      name: X-Api-Key
      in: header
      description: >-
        Standard CRM API User auth token

  requestBodies:
    ExternalLeads:
      content:
        application/json:
          schema:
            required: 
              - firstName
              - lastName
              - addressStreet
              - addressCity
              - addressState
              - addressPostalCode
              - debtAmount
              - timeZone
              - emailAddress
            properties:
              firstName:
                type: string
                maxLength: 255
                example: 'Jhon'
                nullable: false
              lastName:
                type: string
                maxLength: 255
                nullable: false
                example: 'Smith'
              emailAddress:
                $ref: '#/components/schemas/EmailAddress'
              phoneNumber:
                type: string
                maxLength: 14
                pattern: '^\([0-9]{3}\)\s[0-9]{3}\-[0-9]{4}$'
                example: '(111) 111-1111'
              addressStreet:
                type: string
                maxLength: 255
                example: '2522 Chambers Road Suite 184'
              addressCity:
                type: string
                maxLength: 100
                example: Tustin
              addressState:
                type: string
                maxLength: 100
                example: CA
              addressPostalCode:
                type: string
                maxLength: 11
                example: '92780'
              debtAmount:
                type: string
                format: float
                nullable : false
                enum:
                  - '$5,000 - $9,999'
                  - '$10,000 - $19,999'
                  - '$20,000 - $29,999'
                  - '$30,000 - $39,999'
                  - '$40,000 - $49,999'
                  - '$50,000 - $59,999'
                  - '$60,000 - $69,999'
                  - '$70,000 - $79,999'
                  - '$80,000 - $89,999'
                  - '$90,000 - $99,999'
                  - 'More than $100,000'
              timeZone:
                type: string
                enum:
                  - AST
                  - EST
                  - CST
                  - MST
                  - PST
                  - AKT
                  - HAT
              sidOrpid: 
                description: SID or PID for the lead.
                type: string
                maxLength: 255
                example: '852d9f51-d5bf-4584-991e-5a79bef69dc1'
              additionalInformation:
                type: object
                example:
                  IP Address: '38.96.178.67'
                  Ad Group: ''
                  Campaign Name: ''
                  Search Keyword: ''
                  Company/Household: ''
              utmSource:
                type: string
                maxLength: 255
                nullable: true
                example: 'facebook'
              utmMedium:
                type: string
                nullable: true
                maxLength: 255
                enum:
                  - organic
                  - cpc 
                  - email 
                  - affliate
                  - direct
              utmCampaign:
                type: string
                nullable: true
                maxLength: 255
              utmAdditionalFields:
                type: object

  # Response payload
  responses:
    BadRequest:
      description: Client Side Error, Bad Request
      content:
        application/json:
          schema:
            oneOf:
              - type: string
                nullable: true
              - type: object
                required:
                  - status
                  - message
                  - data
                properties:
                  status:
                    type: string
                    enum:
                      - BAD_REQUEST
                  message:
                    type: string
                    maxLength: 255
                  data:
                    type: object
      headers:
        X-Status-Reason:
          description: Bad Request
          schema:
            type: string
            nullable: true
          examples:
            Forbidden:
              value:
                X-Status-Reason: ''

    Forbidden:      
      description: API User is forbidden from making changes to this entry in CRM
      content:
        application/json:
          examples:
            Forbidden:
              value: ''
          schema:
            type: string
            nullable: true
      headers:
        X-Status-Reason:
          description: Forbidden
          schema:
            type: string
            nullable: true
          examples:
            Forbidden:
              value:
                X-Status-Reason: ''

    Unauthorized:
      description: Authorization Failure
      content:
        application/json:
          examples:
            Auth Token Not Provided:
              value: ''
          schema:
            type: string
            nullable: true
      headers:
        X-Status-Reason:
          description: Unauthorized
          schema:
            type: string
            nullable: true
          examples:
            Unauthorized:
              value:

    InternalServerError:
      description: Requested resource was not found.
      content:
        application/json:
          schema:
            type: object
            required:
              - status
              - message
              - data
            properties:
              status:
                type: string
                enum:
                  - FAILURE
                  - SUCCESS
              message:
                type: string
                maxLength: 255
      headers:
        X-Status-Reason:
          description: Internal Server Error
          schema:
            type: string
            nullable: true
            example: Duplicate entries found.
  
    NotFound:
      description: CRM Not Found Response
      content:
        application/json:
          examples:
            NotFound:
              value: ''
          schema:
            type: string
            nullable: true
      headers:
        X-Status-Reason:
          description: Record does not exist.
          schema:
            type: string
            nullable: true
            example: Record does not exist.
          examples:
            NotFound:
              value:
                X-Status-Reason: Record does not exist.
  
    MaintenanceMode:
      description: CRM is in maintenance mode
      content:
        application/json:
          schema:
            type: string
            nullable: true
          examples:
            Service Unavailable:
              value:
      headers:
        X-Status-Reason:
          description: Service Unavailable
          schema:
            type: string
            example: 'Application is in maintenance mode.'

    BadGateway:
      description: Bad Gateway
      content:
        application/json:
          examples:
            BadGateway:
              value: |
                <html>
                <head><title>502 Bad Gateway</title></head>
                <body>
                <center><h1>502 Bad Gateway</h1></center>
                <hr><center>nginx/1.15.8</center>
                </body>
                </html>
          schema:
            type: string
            nullable: true
            format: html
      headers:
        Content-Type:
          description: Response content type
          schema:
            type: string
            example: text/html

  # Response Headers
  headers:
    X-Status-Reason:
      description: Failure Reasons
      schema:
        type: string
    Content-Type:
      description: Response Content-Type
      schema:
        type: string
        enum:
          - application/json
          - text/html

  # Models where data is stored and reused
  schemas:
    EmailAddress:
      type: string
      format: email
      maxLength: 255
